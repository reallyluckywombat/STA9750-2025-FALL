---
title: "Mini-Project 01: Netflix Top 10 Analysis"
format: 
  html:
    theme: morph
    css: custom.css
    toc: true
    toc-location: right
    toc-depth: 3
    code-fold: true
---

2025 has been a blockbuster year for Netflix with standout releases like *Squid Games* Season 2, *Wednesday* Season 2, and animated debut of *KPOP Demon Hunters*. This momentum isn't slowing down. With the highly anticipated final season of *Stranger Things* still to come, Netflix's success is only set to grow. 

Let's take a deeper dive on the successful programming in the past few years. 


# Importing and Prepping Data
### Aquiring data from [Tudum](https://www.netflix.com/tudum/top10) by Netflix
```{r}

if(!dir.exists(file.path("data", "mp01"))){
  dir.create(file.path("data", "mp01"), showWarnings=FALSE, recursive=TRUE)
}

GLOBAL_TOP_10_FILENAME <- file.path("data", "mp01", "global_top10_alltime.csv")

if(!file.exists(GLOBAL_TOP_10_FILENAME)){
  download.file("https://www.netflix.com/tudum/top10/data/all-weeks-global.tsv", 
                destfile=GLOBAL_TOP_10_FILENAME)
}

COUNTRY_TOP_10_FILENAME <- file.path("data", "mp01", "country_top10_alltime.csv")

if(!file.exists(COUNTRY_TOP_10_FILENAME)){
  download.file("https://www.netflix.com/tudum/top10/data/all-weeks-countries.tsv", 
                destfile=COUNTRY_TOP_10_FILENAME)}
```
### Loading packages
```{r}
#| message: false

if(!require("tidyverse")) install.packages("tidyverse")
library(readr)
library(dplyr)
library(lubridate)
```
### Importing Top 10 Global Data
```{r}
#| message: false

GLOBAL_TOP_10 <- read_tsv(GLOBAL_TOP_10_FILENAME)
```
## Task 2: Data Cleaning
Replacing all the 'N/A' values with NA in the season_title column
```{r}
GLOBAL_TOP_10 <- GLOBAL_TOP_10 |>
  mutate(season_title = if_else(season_title == 'N/A', NA_character_, season_title))
```
## Task 3: Data Import
Importing Top 10 Country Data
```{r}
#| message: false

COUNTRY_TOP_10 <- read_tsv(COUNTRY_TOP_10_FILENAME, na = 'N/A')
```

## Initial Data Exploration
```{r}
#| message: false
if(!require("DT"))
library(DT)
```
### Let's take a peek of the Global Top 10 data
```{r}
GLOBAL_TOP_10 |> 
  head(n=20) |>
  datatable(options=list(searching=FALSE, info=FALSE))
```
### Final look at cleaned dataset
```{r}
#| code-fold: true
#creating a function to edit column names 
library(stringr)
format_titles <- function(df){
  colnames(df) <- str_replace_all(colnames(df), "_", " ") |> str_to_title()
  df}

# using the function we made, adding commas to large numbers and dropping 
# a column and changing runtime from hour to minutes
GLOBAL_TOP_10 |> 
  mutate(`runtime_(minutes)` = round(60 * runtime)) |>
  select(-season_title, -runtime) |>
  format_titles() |>
  head(n=20) |>
  datatable(options=list(searching=FALSE, info=FALSE)) |>
  formatRound(c('Weekly Hours Viewed', 'Weekly Views'))
```

# Task 4: Exploratory Data Analysis
The dataset is now ready to explore! Let's see what Netflix programs are charting the top 10 around the world. 

### 1. How many different countries does Netflix operate in? 
```{r}
#| code-fold: true
total_country_count <- COUNTRY_TOP_10 |> 
  summarise(country_count = n_distinct(country_name))
```
Netflix operates in **`r total_country_count`** different countries! 

### 2. Which non-English-language film has spent the most cumulative weeks in the global top 10? How many weeks did it spend?
```{r}
#| code-fold: true
longest_charting_film <- GLOBAL_TOP_10 |>
  filter(category == 'Films (Non-English)') |>
  filter(cumulative_weeks_in_top_10 == max(cumulative_weeks_in_top_10))|>
  select(show_title, cumulative_weeks_in_top_10) |>
  slice_max(cumulative_weeks_in_top_10) |>
  pull(show_title)

longest_chart_streak <- GLOBAL_TOP_10 |>
  filter(category == 'Films (Non-English)') |>
  filter(cumulative_weeks_in_top_10 == max(cumulative_weeks_in_top_10))|>
  select(show_title, cumulative_weeks_in_top_10) |>
  slice_max(cumulative_weeks_in_top_10) |>
  pull(cumulative_weeks_in_top_10)
```
**`r longest_charting_film`** spent the most cumulative weeks in the global top 10 out of all the Non-English Films for **`r longest_chart_streak`** weeks.

### 3. What is the longest film (English or non-English) to have ever appeared in the Netflix global Top 10? How long is it in minutes?
```{r}
#| code-fold: true
show_title_3 <- GLOBAL_TOP_10 |> 
  mutate(runtime_in_minutes = round(60 * runtime)) |>
  filter(category == 'Films (English)' | category == 'Films (Non-English)') |>
  distinct(category,show_title, .keep_all = TRUE)|>
  select(category,show_title, runtime_in_minutes) |>
  slice_max(runtime_in_minutes)|>
  pull(show_title)

runtime_longest_3 <- GLOBAL_TOP_10 |> 
  mutate(runtime_in_minutes = round(60 * runtime)) |>
  filter(category == 'Films (English)' | category == 'Films (Non-English)') |>
  distinct(category,show_title, .keep_all = TRUE)|>
  select(category,show_title, runtime_in_minutes) |>
  slice_max(runtime_in_minutes)|>
  pull(runtime_in_minutes)
```
**`r show_title_3`** is the longest film to appear 
in the Global Top 10 chart;it is **`r runtime_longest_3`** minutes long.

### 4. For each of the four categories, what program has the most total hours of global viewership?
```{r}
#| message: false
GLOBAL_TOP_10 |> 
  filter(category %in% c('Films (English)', 'Films (Non-English)', 'TV (Non-English)', 'TV (English)')) |>
  group_by(category, show_title) |>
  summarise(total_hours_view = sum(weekly_hours_viewed)) |>
  slice_max(total_hours_view) |>
  format_titles() |>
  datatable(options=list(searching=FALSE, info=FALSE))|>
  formatRound(c('Total Hours View'))
```

### 5. Which TV show had the longest run in a country’s Top 10? How long was this run and in what country did it occur?
```{r}
#| code-fold: true
show_title_5 <- COUNTRY_TOP_10 |>
  filter(category == 'TV') |>
  filter(cumulative_weeks_in_top_10 == max(cumulative_weeks_in_top_10)) |>
  select(country_name, show_title, longest_run_in_weeks = cumulative_weeks_in_top_10)|>
  pull(show_title)

country_5 <- COUNTRY_TOP_10 |>
  filter(category == 'TV') |>
  filter(cumulative_weeks_in_top_10 == max(cumulative_weeks_in_top_10)) |>
  select(country_name, show_title, longest_run_in_weeks = cumulative_weeks_in_top_10)|>
  pull(country_name)

week_5 <- COUNTRY_TOP_10 |>
  filter(category == 'TV') |>
  filter(cumulative_weeks_in_top_10 == max(cumulative_weeks_in_top_10)) |>
  select(country_name, show_title, longest_run_in_weeks = cumulative_weeks_in_top_10)|>
  pull(longest_run_in_weeks)
```
**`r show_title_5`** had the longest run in a country's Top 10 chart. It lasted for **`r week_5`** weeks in **`r country_5`**.

### 6. Netflix provides over 200 weeks of service history for all but one country in our data set. Which country is this and when did Netflix cease operations in that country?
```{r}
#| code-fold: true
country_6 <- COUNTRY_TOP_10 |>
  group_by(country_name) |>
  summarise(week_count = n_distinct(week),
            last_week = max(week)) |>
  filter(week_count <= 200)|>
  pull(country_name)

last_week_6 <- COUNTRY_TOP_10 |>
  group_by(country_name) |>
  summarise(week_count = n_distinct(week),
            last_week = max(week)) |>
  filter(week_count <= 200)|>
  pull(last_week)
```
Netflix ceased operations in **`r country_6`** in **`r last_week_6`**. 

### 7. What is the total viewership of the TV show Squid Game?
```{r}
#| code-fold: true
SG_total_hours <- GLOBAL_TOP_10 |>
  filter(season_title %in% c('Squid Game: Season 1', 
                            'Squid Game: Season 2',
                            'Squid Game: Season 3')) |> 
  summarise(total_hours = signif(sum(weekly_hours_viewed),digits = 3))|>
  pull(total_hours)
```
Counting all three seasons, Squid Games has a total of **`r format(SG_total_hours, big.mark = ",", scientific = FALSE)`** hours of watch time. With a total of 22 episodes that are all approximately a little under an hour, and assuming watchers are watching all episodes of the tv show, 18 million subscribers have watch Squid Games. 

Another way to calculate Squid Games viewership is to find the sum of all weekly views.
```{r}
#| code-fold: true
SG_total_views <- GLOBAL_TOP_10 |>
  filter(season_title %in% c( 'Squid Game: Season 1',
                              'Squid Game: Season 2',
                              'Squid Game: Season 3')) |> 
  summarise(total_views = sum(weekly_views, na.rm = TRUE))|>
  pull(total_views)
```
This method calculates that around **`r format(SG_total_views, big.mark = ",", scientific = FALSE)`** people watched Squid Games. It is important to note that there are missing weekly views values from 2021-09-19 to 2022-06-19, meaning the total view count is not as high as it could be. Nonetheless, the view count shows the significant success of all three seasons of Squid Games. 

The first method is assuming that Netflix users watch all episodes of Squid Games while the second method shows how many times a Netflix user watched an individual episode. 

### 8. Approximately how many views did Red Notice receive in 2021?
```{r}
#| code-fold: true
view_count_8 <- GLOBAL_TOP_10 |>
  filter(year(week)== 2021) |>
  filter(show_title == 'Red Notice') |>
  summarise(total_hours_watched = sum(weekly_hours_viewed)) |> 
  summarise(view_count = total_hours_watched/(118/60))|>
  pull(view_count)
```
Red Notice recieved around **`r format(view_count_8, big.mark = ",", scientific = FALSE)`** views in 2021. According to the Netflix's Tudum, Red Notice is the second most popular English Language [film](https://www.netflix.com/tudum/top10/most-popular) of all time.

### 9. How many Films reached Number 1 in the US but did not originally debut there? What is the most recent film to pull this off?
```{r}
#| code-fold: true
US_TOP_10_RISERS <- COUNTRY_TOP_10 |> 
  filter(category == 'Films', 
         country_name == 'United States') |> 
  group_by(show_title)|>
  summarise(debut_week = min(week),
            debut_rank = weekly_rank[week == debut_week][1],
            reached_1 = max(weekly_rank == 1) == 1) |>
  ungroup() |>
  filter(debut_rank>1,reached_1)

film_count_9 <- US_TOP_10_RISERS |>
  summarise(film_count = n_distinct(show_title))

most_recent_riser <- COUNTRY_TOP_10 |>
  filter(category == 'Films',
         country_name == 'United States',
         weekly_rank == 1,
         show_title %in% US_TOP_10_RISERS$show_title) |>
  group_by(show_title) |>
  summarise(recent_1 = max(week)) |>
  ungroup() |>
  arrange(desc(recent_1)) |>
  slice(1)|>
  pull(show_title)
```
**`r film_count_9`** films reached Number 1 in the US but did not originally debut there. The most recent film to do this is **`r most_recent_riser`**.

### 10. Which TV show/season hit the top 10 in the most countries in its debut week? In how many countries did it chart?
```{r}
#| code-fold: true
show_in_most_10 <- COUNTRY_TOP_10 |> 
  filter(category == 'TV') |>
  group_by(show_title,country_name) |> 
  summarise(debut_week = min(week), .groups = 'drop') |>
  group_by(show_title, debut_week) |>
  summarise(countries_charted = n_distinct(country_name), .groups = 'drop') |>
  arrange(desc(countries_charted)) |>
  head(1)|>
  pull(show_title)
```
**`r show_in_most_10`** hit the top 10 in the most countries in its debut week. It charted in 94 countries. 

# Press Releases: 

# 1. The Not-So-Strange Anticipation of *Stranger Things* Season 5
![](https://external-content.duckduckgo.com/iu/?u=https%3A%2F%2Fblackstarnews.com%2Fwp-content%2Fuploads%2F2024%2F11%2FStranger-Things-Season-5.jpg&f=1&nofb=1&ipt=6c97feca4ec567f513c2468ddc91e118e0a0ddd445fab5715a526fa43ca531cc)

Fans have been on the edge of their seats since the summer of 2022, eagerly awaiting the final installment of *Stranger Things*. Still not convinced of its impact? Let’s take a look at the success of the previous seasons.

```{r}
#| code-fold: true
STRANGER_THINGS <- GLOBAL_TOP_10 |>
  filter(show_title == 'Stranger Things') |>
  mutate(season_title = if_else(is.na(season_title), 'Stranger Things 1', season_title))
```
### Here are the total hours viewed by each season. 
```{r}
#| code-fold: true
STRANGER_THINGS |>
  group_by(season_title) |>
  summarise(total_hours_viewed = sum(weekly_hours_viewed))|>
  format_titles() |>
  datatable(options=list(searching=FALSE, info=FALSE))
```
The table shows that seasons 1-3 were consistent in watch time while season 4 has a significantly higher count with over 1.5 trillion more hours watched. In order to understand this significant difference, let's take a gander at previous season information. 
```{r}
#| code-fold: true
ST_release_schedule <- data.frame(
  season = c('Season 1', 'Season 2','Season 3','Season 4 Pt.1',
             'Season 4 Pt.2','Season 5 Pt.1', 'Season 5 Pt.2', 'Season 5 Pt.3'),
  episode_count = c(8,9,8,7,2,4,3,1),
  release_date = as.Date(c('2016-07-15', '2017-10-27', '2019-07-04', '2022-05-27', 
                           '2022-07-01','2025-11-26', '2025-12-25', '2025-12-31')))

ST_release_schedule |> 
  format_titles() |>
  head(n=8) |>
  format_titles() |>
  datatable(options=list(searching=FALSE, info=FALSE))
```
release date source: [IMDB](https://www.imdb.com/title/tt4574334/episodes/?season=1&ref_=ttep)

```{r}
#| code-fold: true
ST_first_week <- STRANGER_THINGS |>
  summarise(first_week = min(week))

ST_last_week <- STRANGER_THINGS |>
  summarise(last_week = max(week))
```
### Stranger Things first appeared on the Global Top 10 on `r ST_first_week` and last appeared on `r ST_last_week`. 

### Important Disclaimers
1. Missing Data
- Our data only includes data from May 2022, while the first season was released in 2016. We are missing six years of data, a significant loss when analyzing watching patterns.
2. Incomplete picture
- While the Netflix's Top 10 data is effective in showing the top charting programming, it does not include weekly views when the show was not on the Top 10 charts. This results in not not having the complete extent of how many people are actually watching *Stranger Things*. 

### This being said, the Netflix Top 10 still shows the significant success of the show. 
```{r}
#| code-fold: true
STRANGER_THINGS |>
  group_by(season_title) |>
  summarise(weeks_in_top_10 = max(cumulative_weeks_in_top_10))|>
  format_titles() |>
  datatable(options=list(searching=FALSE, info=FALSE))
```
All 4 seasons charted in the Global Top 10 for at least 10 weeks! Let's compare to other English language tv shows in the Global Top 10. 

### Top 10 English Language TV shows that spent the most time in the Top 10
```{r}
#| code-fold: true
st_total_show_count <- GLOBAL_TOP_10|>
  filter(category == 'TV (English)')|>
  summarise(total_english_lang_tv_shows = n_distinct(show_title))|>
  pull(total_english_lang_tv_shows)

GLOBAL_TOP_10 |>
  filter(category == 'TV (English)')|>
  group_by(show_title)|>
  summarise(weeks_spent_in_top_10 = max(cumulative_weeks_in_top_10))|>
  slice_max(weeks_spent_in_top_10, n=10)|>
  format_titles() |>
  datatable(options=list(searching=FALSE, info=FALSE))
```
Out of all **`r st_total_show_count`** English Language TV Shows on Netflix, *Stranger Things* is the fifth highest-charting TV show in the Top 10! Because *Wednesday* Season 1 was released in 2022, we have more complete data on its cumulative weeks in the Top 10, which is important to remember when comparing the two shows. 

### Countries *Stranger Things* Charted in
```{r}
#| code-fold: true
COUNTRY_TOP_10 |>
  filter(show_title == 'Stranger Things') |>
  group_by(country_name) |>
  summarise(total_weeks_in_top_10 = max(cumulative_weeks_in_top_10))|>
  arrange(desc(total_weeks_in_top_10)) |>
  format_titles() |>
  datatable(options=list(searching=FALSE, info=FALSE))
```
*Stranger Things* charted in 93 countries and held a spot in the Global Top 10 for multiple consecutive weeks. The data clearly highlights its massive global impact, with record-breaking viewership numbers  confirming its place as one of Netflix’s most successful shows. The final season will start streaming November 26th this year!

# 2. Tapping into a Billion Viewers: Netflix’s Market Opportunity in India

<div style="text-align: center;">
  <img src=https://external-content.duckduckgo.com/iu/?u=http%3A%2F%2Fcinemasmachar.com%2Fwp-content%2Fuploads%2F2024%2F11%2FHaseen-Dillruba-2021-1024x683.jpg&f=1&nofb=1&ipt=e6ec18226a79c0f2c60e431ea2cf8b517c4518a19b86961b2a1135f2fde8560a width="400"/> </div>

India is the most populous country in the world, with nearly 1.5 billion people, that’s a lot of people to entertain. With a rapidly growing digital audience and expanding streaming access, India represents a major market opportunity for Netflix.

Let’s explore how Hindi-language programming has performed in Netflix’s Top 10.

### Creating a dataset of programs that charted in India but not in the US
```{r}
#| code-fold: true
#creating a variable with India's Top 10
india_top_10_show_titles <- COUNTRY_TOP_10 |>
  filter(country_name == 'India')|>
  distinct(show_title)
  
#creating a variable with US's Top 10
us_top_10_show_titles <- COUNTRY_TOP_10 |>
  filter(country_name =='United States')|>
  distinct(show_title)
  
#Programs that charted in India but never in the US
india_only_show_titles <- india_top_10_show_titles |>
  filter(!show_title %in% us_top_10_show_titles$show_title)

# creating India's Top 10 as a new variable
india_top_10 <- COUNTRY_TOP_10 |>
  filter(country_name == 'India')|>
  filter(show_title %in% india_only_show_titles$show_title)
```

### Top Films that Charted in India's Top 10
```{r}
#| code-fold: true
india_top_10|>
  filter(category == "Films")|>
  group_by(show_title)|>
  summarise(weeks_in_top_10 = max(cumulative_weeks_in_top_10))|>
  slice_max(weeks_in_top_10, n=8)|>
  format_titles() |>
  datatable(options=list(searching=FALSE, info=FALSE))
```
*Haseen Dillruba* spent 21 weeks in India's top 10! Let's look at the movie's success in detail. 

### Week and ranking of *Haseen Dillruba* in India's Top 10
```{r}
#| code-fold: true
india_top_10 |>
  filter(show_title == 'Haseen Dillruba')|>
  select(week,weekly_rank,cumulative_weeks_in_top_10)|>
  format_titles() |>
  datatable(options=list(searching=FALSE, info=FALSE))
```
This is interesting; *Haseen Dillruba* first debuted in the Top 10 in the summer of 2021, and then made a return in the summer of 2024. This suggests that even older content can experience renewed popularity and chart-topping performace over time. Next, lets take a look at TV shows. 

### Top TV shows that charted in India's Top 10
```{r}
#| code-fold: true
india_top_10|>
  filter(category == "TV")|>
  group_by(show_title)|>
  summarise(weeks_in_top_10 = max(cumulative_weeks_in_top_10))|>
  slice_max(weeks_in_top_10, n=10)|>
  format_titles() |>
  datatable(options=list(searching=FALSE, info=FALSE))
```

### Lets take a look at *The Great Indian Kapil Show*.
```{r}
#| code-fold: true
india_top_10 |>
  filter(show_title == 'The Great Indian Kapil Show')|>
  group_by(season_title)|>
  summarise(cumulative_weeks_in_top_10 = max(cumulative_weeks_in_top_10))|>
  select(season_title, cumulative_weeks_in_top_10)|>
  format_titles() |>
  datatable(options=list(searching=FALSE, info=FALSE))
```
The table shows that each season spent at least 14 weeks in the top 10, a strong sign of consistent performance. Similar to the film *Haseen Dillruba*, this suggests a pattern of sustained audience interest over time. Now, let’s take a look at how The *Great Indian Kapil Show* performed globally.

### *The Great Indian Kapil Show* Global Performace
```{r}
#| code-fold: true
GLOBAL_TOP_10|>
  filter(show_title == 'The Great Indian Kapil Show')|>
  group_by(season_title)|>
  summarise(total_views = sum(weekly_views),
            highest_rank = min(weekly_rank),
            weeks_charted = max(cumulative_weeks_in_top_10))|>
  format_titles() |>
  datatable(options=list(searching=FALSE, info=FALSE))
```
*The Great Indian Kapil Show* broke into the Global Top 10, becoming the ["first Indian series on Netflix to trend" worldwide for four weeks](https://www.dnaindia.com/bollywood/report-this-show-is-first-indian-series-on-netflix-to-trend-globally-the-great-indian-kapil-show-3087039). Its success signals not just strong local interest, but a growing international appetite for Indian programming.

*Haseen Dillruba* and *The Great Indian Kapil Show* are just two examples that highlight the rising success of Hindi Language programming for Netflix. The data makes it clear: there's a string opportunity for continued growth in Indian/Hindi Language programming. 


# 3. They're Going Up, Up, Up... The Top Charts: KPOP Demon Hunters
![](https://cdn.prod.website-files.com/5ed2cdc2387b7bcba1204550/68b867f27770c3bed85b69bc_Demon%20hunters.jpg)
The original animated film KPOP Demon Hunters, directed by Maggie Kang and Chris Appelhans and starring Arden Cho, May Hong, and Ji-young Yoo, follows three K-pop idols who also battle soul-sucking demons.

Within just 15 weeks of its debut, KPOP Demon Hunters(KDH) has become the #1 most popular movie of all time on Netflix. Just how successful is *KDH*? Let’s take a look.


### *KDH* Total Views Globally
```{r}
#| code-fold: true
kdh_total_views<- GLOBAL_TOP_10 |>
  filter(show_title == 'KPop Demon Hunters') |>
  summarise(total_views = sum(weekly_views))|>
  pull(total_views)
```
*KDH* already garnered **`r format(kdh_total_views, big.mark = ",", scientific = FALSE)`** views. Earlier in the exploratory data analysis, we learn that *Red Notice*, Netflix's second all time most popular movie, recieved **`r format(view_count_8, big.mark = ",", scientific = FALSE)`** views in 2021. This comparison highlights the record-breaking success KPOP Demon Hunters is achieving.

### Number of Weeks KDP spent in the Global Top 10
```{r}
#| code-fold: true
GLOBAL_TOP_10|>
  filter(show_title == 'KPop Demon Hunters')|>
  select(week, weekly_rank, cumulative_weeks_in_top_10)|>
  format_titles() |>
  datatable(options=list(searching=FALSE, info=FALSE))
```
*KPOP Demon Hunter* premiered on Netflix on June 20, 2025. In its first week, it debuted at #2 on the global charts and has consistently remained in the top two ever since. Now, let's take a step back and explore how *KDH* has performed across different countries.  

### Countries *KDH* Charted in

```{r}
#| code-fold: true
COUNTRY_TOP_10 |>
  filter(show_title == 'KPop Demon Hunters')|>
  group_by(country_name)|>
  summarise(total_weeks_kdp = max(cumulative_weeks_in_top_10))|>
  arrange(desc(total_weeks_kdp))|>
  format_titles() |>
  datatable(options=list(searching=FALSE, info=FALSE))

kdh_country_count <- COUNTRY_TOP_10 |>
  summarise(total_countries = n_distinct(country_name))
```
Insanity. KPOP Demon Hunters has topped the charts for at least 12 weeks in **93 out of `r kdh_country_count`** countries. The honmoon is sealing globally (yes, that only makes sense if you’ve seen the movie).

Even if animated films or K-pop aren't your thing, the numbers might be enough to make you wonder: is this movie worth a watch? You can now stream the #1 all time top movie on Netflix. 

### It’s been a record-breaking year for Netflix, with exciting new programming, a growing global presence, and the continued success of its existing shows. Who knows, 2026 might be even more groundbreaking!
